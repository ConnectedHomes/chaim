AWSTemplateFormatVersion: 2010-09-09
Parameters:
  ChaimUser:
    Type: String
    Description: The IAM Chaim User
  ChaimUserPoolName:
    Type: String
    Description: Cognito User Pool Name
  Owner:
    Type: String
    Description: The owner of the product
  Product:
    Type: String
    Description: The product this stack provides
  Environment:
    Type: String
    Description: The environment the product will be built in
Resources:
  ChaimCognito0:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: https://s3.eu-west-1.amazonaws.com/chaimcloudformationtemplates/fe7eebe66668f9631002148ddcc4489c.template
      Parameters:
        ChaimUserPoolName:
          Ref: ChaimUserPoolName
        Owner:
          Ref: Owner
        Product:
          Ref: Product
        Environment:
          Ref: Environment
  ChaimIAM0:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: https://s3.eu-west-1.amazonaws.com/chaimcloudformationtemplates/06c1c38a0fc0ce9a8043cc198cfb5433.template
      Parameters:
        ChaimCognitoUserPool:
          Fn::GetAtt:
          - ChaimCognito0
          - Outputs.ChaimCognitoUserPoolId
        ChaimUser:
          Ref: ChaimUser
        Environment:
          Ref: Environment
        Owner:
          Ref: Owner
        Product:
          Ref: Product
    DependsOn: ChaimCognito0
  ChaimKMS0:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: https://s3.eu-west-1.amazonaws.com/chaimcloudformationtemplates/b646364b19393a4ea2854d690eebf8d1.template
      Parameters:
        Environment:
          Ref: Environment
        Owner:
          Ref: Owner
        Product:
          Ref: Product
    DependsOn: ChaimIAM0
  ChaimIAM1:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: https://s3.eu-west-1.amazonaws.com/chaimcloudformationtemplates/b8f85de70ee9cb38e91a9d4d477f9bf5.template
      Parameters:
        ChaimKMSKey:
          Fn::GetAtt:
          - ChaimKMS0
          - Outputs.ChaimKMSKeyId
        Environment:
          Ref: Environment
        Owner:
          Ref: Owner
        Product:
          Ref: Product
    DependsOn: ChaimKMS0
